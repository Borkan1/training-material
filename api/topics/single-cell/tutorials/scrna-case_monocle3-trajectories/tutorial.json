{
  "layout": "tutorial_hands_on",
  "title": "Inferring single cell trajectories (Monocle3)",
  "subtopic": "single-cell-CS",
  "priority": 5,
  "zenodo_link": "https://zenodo.org/records/10397366",
  "redirect_from": [
    "/topics/transcriptomics/tutorials/scrna-case_monocle3-trajectories/tutorial",
    "/short/single-cell/scrna-case_monocle3-trajectories",
    "/short/T00249"
  ],
  "questions": [
    "How can I prepare input files for Monocle starting from an AnnData object?",
    "How can I infer lineage relationships between clusters, without a time series?",
    "What can trajectory analysis tell us?"
  ],
  "objectives": [
    "Identify which operations to perform on an AnnData object to obtain the files needed for Monocle",
    "Follow the Monocle3 workflow and choose the right parameter values",
    "Compare the outputs from Scanpy and Monocle",
    "Interpet trajectory analysis results"
  ],
  "time_estimation": "2H",
  "key_points": [
    "You should understand your data object sufficiently to be able to extract relevant information for further analysis.",
    "Trajectory analysis is highly dependent on the parameter values you choose, as such â€˜inferred relationshipsâ€™ are a bigger mathematical leap. Therefore, you should always check if the output makes biological sense before proceeding to the next step.",
    "Comparing the output of two different methods applied on the same dataset might be useful to confirm the results, to ensure that the findings are reliable and even sometimes to find a new piece of information."
  ],
  "requirements": [
    {
      "type": "internal",
      "topic_name": "single-cell",
      "tutorials": [
        "scrna-case_alevin",
        "scrna-case_alevin-combine-datasets",
        "scrna-case_basic-pipeline",
        "scrna-case_JUPYTER-trajectories",
        "scrna-data-ingest"
      ]
    }
  ],
  "tags": [
    "10x",
    "paper-replication",
    "R"
  ],
  "contributions": {
    "authorship": [
      "wee-snufkin"
    ],
    "editing": [
      "hexylena",
      "nomadscientist"
    ],
    "testing": [
      "nomadscientist"
    ],
    "funding": [
      "epsrc-training-grant"
    ]
  },
  "mathjax": null,
  "short_id": "T00249",
  "url": "/topics/single-cell/tutorials/scrna-case_monocle3-trajectories/tutorial.html",
  "topic_name": "single-cell",
  "tutorial_name": "scrna-case_monocle3-trajectories",
  "dir": "topics/single-cell/tutorials/scrna-case_monocle3-trajectories",
  "id": "single-cell/scrna-case_monocle3-trajectories",
  "video_library": {
    "tutorial": null,
    "slides": null,
    "demo": null,
    "both": {
      "description": null,
      "materials": [
        {
          "link": "topics/single-cell/tutorials/scrna-case_monocle3-trajectories/tutorial.html",
          "type": "Tutorial"
        }
      ],
      "tags": [
        "single-cell",
        "transcriptomics"
      ],
      "type": "Tutorial",
      "versions": [
        {
          "link": "Espl6qSbu3Y",
          "date": "2023-04-11",
          "length": "15M",
          "speakers": [
            "wee-snufkin"
          ],
          "captions": [
            "wee-snufkin"
          ]
        }
      ],
      "gtn_id": "single-cell/scrna-case_monocle3-trajectories",
      "title": "Inferring single cell trajectories (Monocle3)",
      "captioned": true
    },
    "session": null
  },
  "hands_on": true,
  "slides": false,
  "mod_date": "2023-12-18 11:23:12 +0000",
  "pub_date": "2022-09-30 20:06:34 +0000",
  "version": 31,
  "workflows": [
    {
      "workflow": "Galaxy-Workflow-AnnData_object_to_Monocle_input_files.ga",
      "tests": false,
      "url": "https://training.galaxyproject.org/training-material/topics/single-cell/tutorials/scrna-case_monocle3-trajectories/workflows/Galaxy-Workflow-AnnData_object_to_Monocle_input_files.ga",
      "path": "topics/single-cell/tutorials/scrna-case_monocle3-trajectories/workflows/Galaxy-Workflow-AnnData_object_to_Monocle_input_files.ga",
      "wfid": "single-cell-scrna-case_monocle3-trajectories",
      "wfname": "galaxy-workflow-anndata_object_to_monocle_input_files",
      "trs_endpoint": "https://training.galaxyproject.org/training-material/api/ga4gh/trs/v2/tools/single-cell-scrna-case_monocle3-trajectories/versions/galaxy-workflow-anndata_object_to_monocle_input_files",
      "license": null,
      "creators": [

      ],
      "name": "AnnData object to Monocle input files",
      "title": "AnnData object to Monocle input files",
      "test_results": null,
      "modified": "2024-02-20 16:31:53 +0000",
      "mermaid": "flowchart TD\n  0[\"Input dataset\"];\n  1[\"Input dataset\"];\n  2[\"Inspect AnnData\"];\n  0 -->|output| 2;\n  3[\"Inspect AnnData\"];\n  0 -->|output| 3;\n  4[\"Inspect AnnData\"];\n  1 -->|output| 4;\n  5[\"Filter\"];\n  2 -->|obs| 5;\n  6[\"Column Regex Find And Replace\"];\n  3 -->|var| 6;\n  7[\"Cut\"];\n  5 -->|out_file1| 7;\n  8[\"Cut\"];\n  6 -->|out_file1| 8;\n  9[\"Join two Datasets\"];\n  7 -->|out_file1| 9;\n  4 -->|X| 9;\n  10[\"Advanced Cut\"];\n  9 -->|out_file1| 10;\n  11[\"Transpose\"];\n  10 -->|output| 11;\n  12[\"Join two Datasets\"];\n  8 -->|out_file1| 12;\n  11 -->|out_file| 12;\n  13[\"Advanced Cut\"];\n  12 -->|out_file1| 13;\n"
    },
    {
      "workflow": "Galaxy-Workflow-Monocle3_workflow.ga",
      "tests": false,
      "url": "https://training.galaxyproject.org/training-material/topics/single-cell/tutorials/scrna-case_monocle3-trajectories/workflows/Galaxy-Workflow-Monocle3_workflow.ga",
      "path": "topics/single-cell/tutorials/scrna-case_monocle3-trajectories/workflows/Galaxy-Workflow-Monocle3_workflow.ga",
      "wfid": "single-cell-scrna-case_monocle3-trajectories",
      "wfname": "galaxy-workflow-monocle3_workflow",
      "trs_endpoint": "https://training.galaxyproject.org/training-material/api/ga4gh/trs/v2/tools/single-cell-scrna-case_monocle3-trajectories/versions/galaxy-workflow-monocle3_workflow",
      "license": null,
      "creators": [

      ],
      "name": "Monocle3 workflow",
      "title": "Monocle3 workflow",
      "test_results": null,
      "modified": "2024-02-20 16:31:53 +0000",
      "mermaid": "flowchart TD\n  0[\"Input dataset\"];\n  1[\"Input dataset\"];\n  2[\"Input dataset\"];\n  3[\"Monocle3 create\"];\n  1 -->|output| 3;\n  0 -->|output| 3;\n  2 -->|output| 3;\n  4[\"Monocle3 preprocess\"];\n  3 -->|output_rds| 4;\n  5[\"Monocle3 reduceDim\"];\n  4 -->|output_rds| 5;\n  6[\"Monocle3 partition\"];\n  5 -->|output_rds| 6;\n  7[\"Monocle3 plotCells\"];\n  5 -->|output_rds| 7;\n  8[\"Monocle3 plotCells\"];\n  5 -->|output_rds| 8;\n  9[\"Monocle3 plotCells\"];\n  5 -->|output_rds| 9;\n  10[\"Monocle3 plotCells\"];\n  5 -->|output_rds| 10;\n  11[\"Monocle3 top markers\"];\n  6 -->|output_rds| 11;\n  12[\"Monocle3 plotCells\"];\n  6 -->|output_rds| 12;\n  13[\"Monocle3 plotCells\"];\n  6 -->|output_rds| 13;\n  14[\"Monocle3 plotCells\"];\n  6 -->|output_rds| 14;\n  15[\"Monocle3 learnGraph\"];\n  6 -->|output_rds| 15;\n  16[\"Monocle3 plotCells\"];\n  15 -->|output_rds| 16;\n  17[\"Monocle3 orderCells\"];\n  15 -->|output_rds| 17;\n  18[\"Monocle3 diffExp\"];\n  17 -->|output_rds| 18;\n  19[\"Monocle3 plotCells\"];\n  17 -->|output_rds| 19;\n"
    },
    {
      "workflow": "Trajectory-analysis-using-Monocle3---full-tutorial-workflow.ga",
      "tests": true,
      "url": "https://training.galaxyproject.org/training-material/topics/single-cell/tutorials/scrna-case_monocle3-trajectories/workflows/Trajectory-analysis-using-Monocle3---full-tutorial-workflow.ga",
      "path": "topics/single-cell/tutorials/scrna-case_monocle3-trajectories/workflows/Trajectory-analysis-using-Monocle3---full-tutorial-workflow.ga",
      "wfid": "single-cell-scrna-case_monocle3-trajectories",
      "wfname": "trajectory-analysis-using-monocle3---full-tutorial-workflow",
      "trs_endpoint": "https://training.galaxyproject.org/training-material/api/ga4gh/trs/v2/tools/single-cell-scrna-case_monocle3-trajectories/versions/trajectory-analysis-using-monocle3---full-tutorial-workflow",
      "license": "CC-BY-4.0",
      "creators": [
        {
          "class": "Organization",
          "identifier": "0009-0001-2017-8805",
          "name": "Julia Jakiela"
        }
      ],
      "name": "Trajectory analysis using Monocle3 - full tutorial workflow",
      "title": "Trajectory analysis using Monocle3 - full tutorial workflow",
      "test_results": null,
      "modified": "2024-02-20 16:31:53 +0000",
      "mermaid": "flowchart TD\n  0[\"Input dataset\"];\n  1[\"Input dataset\"];\n  2[\"Inspect AnnData\"];\n  0 -->|output| 2;\n  3[\"Inspect AnnData\"];\n  0 -->|output| 3;\n  4[\"Inspect AnnData\"];\n  1 -->|output| 4;\n  5[\"Filter\"];\n  2 -->|obs| 5;\n  6[\"Column Regex Find And Replace\"];\n  3 -->|var| 6;\n  7[\"Cut\"];\n  5 -->|out_file1| 7;\n  8[\"Cut\"];\n  6 -->|out_file1| 8;\n  9[\"Join two Datasets\"];\n  7 -->|out_file1| 9;\n  4 -->|X| 9;\n  10[\"Advanced Cut\"];\n  9 -->|out_file1| 10;\n  11[\"Transpose\"];\n  10 -->|output| 11;\n  12[\"Join two Datasets\"];\n  8 -->|out_file1| 12;\n  11 -->|out_file| 12;\n  13[\"Advanced Cut\"];\n  12 -->|out_file1| 13;\n  14[\"Monocle3 create\"];\n  5 -->|out_file1| 14;\n  13 -->|output| 14;\n  6 -->|out_file1| 14;\n  15[\"Monocle3 preprocess\"];\n  14 -->|output_rds| 15;\n  16[\"Monocle3 reduceDim\"];\n  15 -->|output_rds| 16;\n  17[\"Monocle3 partition\"];\n  16 -->|output_rds| 17;\n  18[\"Monocle3 plotCells\"];\n  16 -->|output_rds| 18;\n  19[\"Monocle3 plotCells\"];\n  16 -->|output_rds| 19;\n  20[\"Monocle3 plotCells\"];\n  16 -->|output_rds| 20;\n  21[\"Monocle3 plotCells\"];\n  16 -->|output_rds| 21;\n  22[\"Monocle3 top markers\"];\n  17 -->|output_rds| 22;\n  23[\"Monocle3 plotCells\"];\n  17 -->|output_rds| 23;\n  24[\"Monocle3 plotCells\"];\n  17 -->|output_rds| 24;\n  25[\"Monocle3 plotCells\"];\n  17 -->|output_rds| 25;\n  26[\"Monocle3 learnGraph\"];\n  17 -->|output_rds| 26;\n  27[\"Monocle3 plotCells\"];\n  26 -->|output_rds| 27;\n  28[\"Monocle3 orderCells\"];\n  26 -->|output_rds| 28;\n  29[\"Monocle3 diffExp\"];\n  28 -->|output_rds| 29;\n  30[\"Monocle3 plotCells\"];\n  28 -->|output_rds| 30;\n"
    }
  ],
  "api": "https://training.galaxyproject.org/training-material/api/topics/single-cell/tutorials/scrna-case_monocle3-trajectories/tutorial.json",
  "tools": [
    "Cut1",
    "Filter1",
    "join1",
    "toolshed.g2.bx.psu.edu/repos/bgruening/text_processing/tp_cut_tool/1.1.0",
    "toolshed.g2.bx.psu.edu/repos/ebi-gxa/monocle3_create/monocle3_create/0.1.4+galaxy2",
    "toolshed.g2.bx.psu.edu/repos/ebi-gxa/monocle3_diffexp/monocle3_diffExp/0.1.4+galaxy1",
    "toolshed.g2.bx.psu.edu/repos/ebi-gxa/monocle3_learngraph/monocle3_learnGraph/0.1.4+galaxy0",
    "toolshed.g2.bx.psu.edu/repos/ebi-gxa/monocle3_ordercells/monocle3_orderCells/0.1.4+galaxy0",
    "toolshed.g2.bx.psu.edu/repos/ebi-gxa/monocle3_partition/monocle3_partition/0.1.4+galaxy0",
    "toolshed.g2.bx.psu.edu/repos/ebi-gxa/monocle3_plotcells/monocle3_plotCells/0.1.5+galaxy1",
    "toolshed.g2.bx.psu.edu/repos/ebi-gxa/monocle3_preprocess/monocle3_preprocess/0.1.4+galaxy0",
    "toolshed.g2.bx.psu.edu/repos/ebi-gxa/monocle3_reducedim/monocle3_reduceDim/0.1.4+galaxy0",
    "toolshed.g2.bx.psu.edu/repos/ebi-gxa/monocle3_topmarkers/monocle3_topmarkers/0.1.5+galaxy0",
    "toolshed.g2.bx.psu.edu/repos/galaxyp/regex_find_replace/regexColumn1/1.0.2",
    "toolshed.g2.bx.psu.edu/repos/iuc/anndata_inspect/anndata_inspect/0.7.5+galaxy1",
    "toolshed.g2.bx.psu.edu/repos/iuc/datamash_transpose/datamash_transpose/1.1.0+galaxy2"
  ],
  "supported_servers": {
    "exact": [
      {
        "url": "https://usegalaxy.eu",
        "name": "UseGalaxy.eu",
        "usegalaxy": true
      },
      {
        "url": "https://usegalaxy.org",
        "name": "UseGalaxy.org (Main)",
        "usegalaxy": true
      }
    ],
    "inexact": [

    ]
  },
  "topic_name_human": "Single Cell",
  "admin_install": {
    "install_tool_dependencies": true,
    "install_repository_dependencies": true,
    "install_resolver_dependencies": true,
    "tools": [
      {
        "name": "text_processing",
        "owner": "bgruening",
        "revisions": "d698c222f354",
        "tool_panel_section_label": "Text Manipulation",
        "tool_shed_url": "https://toolshed.g2.bx.psu.edu/"
      },
      {
        "name": "monocle3_create",
        "owner": "ebi-gxa",
        "revisions": "ada68a9d0aec",
        "tool_panel_section_label": "Monocle3",
        "tool_shed_url": "https://toolshed.g2.bx.psu.edu/"
      },
      {
        "name": "monocle3_diffexp",
        "owner": "ebi-gxa",
        "revisions": "d43a608d14ac",
        "tool_panel_section_label": "Monocle3",
        "tool_shed_url": "https://toolshed.g2.bx.psu.edu/"
      },
      {
        "name": "monocle3_learngraph",
        "owner": "ebi-gxa",
        "revisions": "5f877012f7af",
        "tool_panel_section_label": "Monocle3",
        "tool_shed_url": "https://toolshed.g2.bx.psu.edu/"
      },
      {
        "name": "monocle3_ordercells",
        "owner": "ebi-gxa",
        "revisions": "3e77dc421569",
        "tool_panel_section_label": "Monocle3",
        "tool_shed_url": "https://toolshed.g2.bx.psu.edu/"
      },
      {
        "name": "monocle3_partition",
        "owner": "ebi-gxa",
        "revisions": "d98b4705eb4c",
        "tool_panel_section_label": "Monocle3",
        "tool_shed_url": "https://toolshed.g2.bx.psu.edu/"
      },
      {
        "name": "monocle3_plotcells",
        "owner": "ebi-gxa",
        "revisions": "91980addce5e",
        "tool_panel_section_label": "Monocle3",
        "tool_shed_url": "https://toolshed.g2.bx.psu.edu/"
      },
      {
        "name": "monocle3_preprocess",
        "owner": "ebi-gxa",
        "revisions": "c150370b514c",
        "tool_panel_section_label": "Monocle3",
        "tool_shed_url": "https://toolshed.g2.bx.psu.edu/"
      },
      {
        "name": "monocle3_reducedim",
        "owner": "ebi-gxa",
        "revisions": "8900e2a18603",
        "tool_panel_section_label": "Monocle3",
        "tool_shed_url": "https://toolshed.g2.bx.psu.edu/"
      },
      {
        "name": "monocle3_topmarkers",
        "owner": "ebi-gxa",
        "revisions": "a4ab4af54b1a",
        "tool_panel_section_label": "Monocle3",
        "tool_shed_url": "https://toolshed.g2.bx.psu.edu/"
      },
      {
        "name": "regex_find_replace",
        "owner": "galaxyp",
        "revisions": "399da6b5ec21",
        "tool_panel_section_label": "Text Manipulation",
        "tool_shed_url": "https://toolshed.g2.bx.psu.edu/"
      },
      {
        "name": "anndata_inspect",
        "owner": "iuc",
        "revisions": "ee98d611afc6",
        "tool_panel_section_label": "Single-cell",
        "tool_shed_url": "https://toolshed.g2.bx.psu.edu/"
      },
      {
        "name": "datamash_transpose",
        "owner": "iuc",
        "revisions": "ac092723240d",
        "tool_panel_section_label": "Join, Subtract and Group",
        "tool_shed_url": "https://toolshed.g2.bx.psu.edu/"
      }
    ]
  },
  "admin_install_yaml": "---\ninstall_tool_dependencies: true\ninstall_repository_dependencies: true\ninstall_resolver_dependencies: true\ntools:\n- name: text_processing\n  owner: bgruening\n  revisions: d698c222f354\n  tool_panel_section_label: Text Manipulation\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: monocle3_create\n  owner: ebi-gxa\n  revisions: ada68a9d0aec\n  tool_panel_section_label: Monocle3\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: monocle3_diffexp\n  owner: ebi-gxa\n  revisions: d43a608d14ac\n  tool_panel_section_label: Monocle3\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: monocle3_learngraph\n  owner: ebi-gxa\n  revisions: 5f877012f7af\n  tool_panel_section_label: Monocle3\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: monocle3_ordercells\n  owner: ebi-gxa\n  revisions: 3e77dc421569\n  tool_panel_section_label: Monocle3\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: monocle3_partition\n  owner: ebi-gxa\n  revisions: d98b4705eb4c\n  tool_panel_section_label: Monocle3\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: monocle3_plotcells\n  owner: ebi-gxa\n  revisions: 91980addce5e\n  tool_panel_section_label: Monocle3\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: monocle3_preprocess\n  owner: ebi-gxa\n  revisions: c150370b514c\n  tool_panel_section_label: Monocle3\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: monocle3_reducedim\n  owner: ebi-gxa\n  revisions: 8900e2a18603\n  tool_panel_section_label: Monocle3\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: monocle3_topmarkers\n  owner: ebi-gxa\n  revisions: a4ab4af54b1a\n  tool_panel_section_label: Monocle3\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: regex_find_replace\n  owner: galaxyp\n  revisions: 399da6b5ec21\n  tool_panel_section_label: Text Manipulation\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: anndata_inspect\n  owner: iuc\n  revisions: ee98d611afc6\n  tool_panel_section_label: Single-cell\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n- name: datamash_transpose\n  owner: iuc\n  revisions: ac092723240d\n  tool_panel_section_label: Join, Subtract and Group\n  tool_shed_url: https://toolshed.g2.bx.psu.edu/\n",
  "tours": false,
  "video": false,
  "translations": {
    "tutorial": [

    ],
    "slides": [

    ],
    "video": false
  },
  "license": "CC-BY-4.0",
  "type": "tutorial",
  "contributors": [
    {
      "name": "Julia Jakiela",
      "email": "juliajot36@gmail.com",
      "joined": "2022-06",
      "id": "wee-snufkin",
      "url": "https://training.galaxyproject.org/training-material/api/contributors/wee-snufkin.json",
      "page": "https://training.galaxyproject.org/training-material/hall-of-fame/wee-snufkin/"
    },
    {
      "name": "Helena Rasche",
      "email": "hexylena@galaxians.org",
      "orcid": "0000-0001-9760-8992",
      "maintainer_contact": "gitter",
      "matrix": "hexylena:matrix.org",
      "joined": "2017-09",
      "elixir_node": "nl",
      "fediverse": "https://galaxians.garden/hexylena",
      "fediverse_flavor": "akkoma",
      "affiliations": [
        "gallantries",
        "by-covid",
        "erasmusmc",
        "elixir-europe",
        "elixir-converge"
      ],
      "former_affiliations": [
        "deNBI",
        "avans-atgm",
        "uni-freiburg"
      ],
      "contact_for_training": false,
      "location": {
        "country": "NL",
        "lat": 51.91,
        "lon": 4.46
      },
      "id": "hexylena",
      "url": "https://training.galaxyproject.org/training-material/api/contributors/hexylena.json",
      "page": "https://training.galaxyproject.org/training-material/hall-of-fame/hexylena/"
    },
    {
      "name": "Wendi Bacon",
      "email": "wendi.bacon@open.ac.uk",
      "twitter": "WendiBacon1",
      "matrix": "nomadscientist:matrix.org",
      "joined": "2020-03",
      "elixir_node": "uk",
      "orcid": "0000-0002-8170-8806",
      "bio": "Lecturer at The Open University",
      "fediverse": "https://mstdn.science/@wendibacon1",
      "fediverse_flavor": "mastodon",
      "id": "nomadscientist",
      "url": "https://training.galaxyproject.org/training-material/api/contributors/nomadscientist.json",
      "page": "https://training.galaxyproject.org/training-material/hall-of-fame/nomadscientist/"
    },
    {
      "name": "Wendi Bacon",
      "email": "wendi.bacon@open.ac.uk",
      "twitter": "WendiBacon1",
      "matrix": "nomadscientist:matrix.org",
      "joined": "2020-03",
      "elixir_node": "uk",
      "orcid": "0000-0002-8170-8806",
      "bio": "Lecturer at The Open University",
      "fediverse": "https://mstdn.science/@wendibacon1",
      "fediverse_flavor": "mastodon",
      "id": "nomadscientist",
      "url": "https://training.galaxyproject.org/training-material/api/contributors/nomadscientist.json",
      "page": "https://training.galaxyproject.org/training-material/hall-of-fame/nomadscientist/"
    },
    {
      "name": "EPSRC Training Grant DTP 2020-2021 Open University",
      "short_name": "EPSRC/OU",
      "github": false,
      "joined": "2022-09",
      "funder": true,
      "funding_statement": "The research internship was supported through EPSRC Training Grant DTP 2020-2021 Open University",
      "url": "https://training.galaxyproject.org/training-material/api/funders/epsrc-training-grant.json",
      "id": "epsrc-training-grant",
      "page": "https://training.galaxyproject.org/training-material/hall-of-fame/epsrc-training-grant/"
    }
  ]
}